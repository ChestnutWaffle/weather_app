<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Weather App</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.1/chart.min.js" integrity="sha512-QSkVNOCYLtj73J4hbmVoOV6KVZuMluZlioC+trLpewV8qMjsWqlIQvkn1KGX2StWvPMdWGBqim1xlC8krl1EKQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <style >
    .canvas {
      margin: 10px auto;
      height: 350px;
      width: 1200px;
      box-shadow: 5px 5px 25px rgba(0, 0, 0, 0.5);
      margin-bottom: 500px;
      padding: 10px 50px;
      border-radius: 10px;
    }
    .canvas>h2{
      margin-left: 50px;
      padding: 15px 0;
    }
  </style>



  </head>
  <body>
    <h1>Weather App</h1>
    <form class="" action="/" method="post">
      <input type="text" name="city" value="" placeholder = "Location" autocomplete="off"/>
    </form>
    <div class="current-forecast">
      <p><%= label %></p>
      <p>Temperature: <%= (current.temp).toFixed(2)  %> &#176;C</p>
      <p>Feels like: <%= (current.feels_like).toFixed(2) %> &#176;C</p>
      <p>Pressure: <%= (current.pressure * 0.0009869233).toFixed(2) %> atm</p>
      <p>Humidity: <%= current.humidity %> %</p>
      <p>Wind Speed: <%= current.wind_speed %> m/sec</p>
      <img src="http://openweathermap.org/img/wn/<%= current.weather[0].icon %>@2x.png" alt="">
      <p>Description: <%= current.weather[0].description %></p>
      <p>Date is: <%= date %></p>
      <p>Time is: <%= time %></p>
    </div>

    <div class="canvas">
      <h2>Hourly Forecast</h2>
      <canvas id="hourly" width="1500" height="300"></canvas>

    </div>
<script>
const ctx = document.getElementById('hourly');
const myChart = new Chart(ctx, {
    type: 'line',
    data: {
        labels: [
          <% (hourlyData.labels).forEach((time)=>{ %>
            '<%= time %>',
          <% }); %>
        ],
        datasets: [
          <% (hourlyData.datasets).forEach((dataset)=> { %>

            {
              label: '<%= dataset.label %>',
              data: [
                <% (dataset.data).forEach((data) =>{ %>
                  <%= data %>,
                <% }) %>
              ],
              backgroundColor: '<%= dataset.backgroundColor %>',
              borderColor: '<%= dataset.borderColor %>',
              borderWidth: <%= dataset.borderWidth %>

            },

          <% }); %>
        ]
    },
    options: {
        scales: {
            y: {
                beginAtZero: true
            }
        }
    }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
  <script>
  if ( window.history.replaceState ) {
    window.history.replaceState( null, null, window.location.href );
  }
  </script>
  </body>
</html>
